(self.webpackChunkwp5_starter_react=self.webpackChunkwp5_starter_react||[]).push([[471],{1072:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(3564),o=n(3835),i=function(e){function t(t){var n=e.call(this)||this;return t instanceof o.SubscriptionClient?n.subscriptionClient=t:n.subscriptionClient=new o.SubscriptionClient(t.uri,t.options,t.webSocketImpl),n}return(0,r.ZT)(t,e),t.prototype.request=function(e){return this.subscriptionClient.request(e)},t}(n(6706).i)},6156:(e,t,n)=>{"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{Z:()=>r})},3391:(e,t,n)=>{"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==c.return||c.return()}finally{if(o)throw i}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}n.d(t,{Z:()=>o})},2465:(e,t,n)=>{"use strict";function r(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}n.d(t,{Z:()=>r})},2471:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>O});var r,o,i=n(6156),a=n(3391),c=n(2465),u=n(2950),l=n.n(u),s=n(5264),p=n(1072),f=n(6620);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m=new p.A({uri:"ws://localhost:4000/",options:{reconnect:!0,playground:"/playground"}}),g=new s.ApolloClient({link:m,uri:"/graphql",cache:new s.InMemoryCache}),y=(0,s.gql)(r||(r=(0,c.Z)(["\n  subscription getMessages {\n    messages {\n      id\n      content\n      user\n    }\n  }\n"]))),h=(0,s.gql)(o||(o=(0,c.Z)(["\n  mutation postMessage($user: String!, $content: String!) {\n    postMessage(user: $user, content: $content)\n  }\n"]))),v=function(e){var t=e.user,n=(0,s.useSubscription)(y).data;return n?l().createElement(l().Fragment,null,n.messages.map((function(e){e.id;var n=e.user,r=e.content;return l().createElement("div",{style:{display:"flex",justifyContent:t===n?"flex-end":"flex-start",paddingBottom:"1em"}},t!==n&&l().createElement("div",{style:{height:50,width:50,marginRight:"0.5em",border:"2px solid #e5e6ea",borderRadius:25,textAlign:"center",fontSize:"18pt",paddingTop:5}},n.slice(0,2).toUpperCase()),l().createElement("div",{style:{background:t===n?"#58bf56":"#e5e6ea",color:t===n?"white":"black",padding:"1em",borderRadius:"1em",maxWidth:"60%"}},r))}))):l().createElement("div",null,"Nothing")},w=function(){var e=(0,u.useState)({user:"Jack",content:""}),t=(0,a.Z)(e,2),n=t[0],r=t[1],o=(0,s.useMutation)(h),i=(0,a.Z)(o,1)[0],c=function(){n.content.length>0&&i({variables:n}),r(b(b({},n),{},{content:""}))};return l().createElement(f.Container,{"data-testid":"chat-app"},l().createElement(v,{user:n.user}),l().createElement(f.Row,null,l().createElement(f.Col,{xs:2,style:{padding:0}},l().createElement(f.FormInput,{label:"User",value:n.user,onChange:function(e){return r(b(b({},n),{},{user:e.target.value}))}})),l().createElement(f.Col,{xs:8},l().createElement(f.FormInput,{"data-testid":"message-input",label:"User",value:n.content,onChange:function(e){return r(b(b({},n),{},{content:e.target.value}))},onKeyUp:function(e){13===e.keyCode&&c()}})),l().createElement(f.Col,{xs:2,style:{padding:0}},l().createElement(f.Button,{onClick:function(){return c()}},"Send"))))};const O=function(){return l().createElement(s.ApolloProvider,{client:g},l().createElement(w,null))}}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93cDUtc3RhcnRlci1yZWFjdC8uL25vZGVfbW9kdWxlcy9AYXBvbGxvL2NsaWVudC9saW5rL3dzL2luZGV4LmpzIiwid2VicGFjazovL3dwNS1zdGFydGVyLXJlYWN0Ly4vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2RlZmluZVByb3BlcnR5LmpzIiwid2VicGFjazovL3dwNS1zdGFydGVyLXJlYWN0Ly4vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FycmF5TGlrZVRvQXJyYXkuanMiLCJ3ZWJwYWNrOi8vd3A1LXN0YXJ0ZXItcmVhY3QvLi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vc2xpY2VkVG9BcnJheS5qcyIsIndlYnBhY2s6Ly93cDUtc3RhcnRlci1yZWFjdC8uL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hcnJheVdpdGhIb2xlcy5qcyIsIndlYnBhY2s6Ly93cDUtc3RhcnRlci1yZWFjdC8uL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9pdGVyYWJsZVRvQXJyYXlMaW1pdC5qcyIsIndlYnBhY2s6Ly93cDUtc3RhcnRlci1yZWFjdC8uL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheS5qcyIsIndlYnBhY2s6Ly93cDUtc3RhcnRlci1yZWFjdC8uL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9ub25JdGVyYWJsZVJlc3QuanMiLCJ3ZWJwYWNrOi8vd3A1LXN0YXJ0ZXItcmVhY3QvLi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdGFnZ2VkVGVtcGxhdGVMaXRlcmFsLmpzIiwid2VicGFjazovL3dwNS1zdGFydGVyLXJlYWN0Ly4vc3JjL0NoYXQuanN4Il0sIm5hbWVzIjpbIldlYlNvY2tldExpbmsiLCJfc3VwZXIiLCJwYXJhbXNPckNsaWVudCIsIl90aGlzIiwiY2FsbCIsInRoaXMiLCJTdWJzY3JpcHRpb25DbGllbnQiLCJzdWJzY3JpcHRpb25DbGllbnQiLCJ1cmkiLCJvcHRpb25zIiwid2ViU29ja2V0SW1wbCIsInByb3RvdHlwZSIsInJlcXVlc3QiLCJvcGVyYXRpb24iLCJfZGVmaW5lUHJvcGVydHkiLCJvYmoiLCJrZXkiLCJ2YWx1ZSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsIndyaXRhYmxlIiwiX2FycmF5TGlrZVRvQXJyYXkiLCJhcnIiLCJsZW4iLCJsZW5ndGgiLCJpIiwiYXJyMiIsIkFycmF5IiwiX3NsaWNlZFRvQXJyYXkiLCJpc0FycmF5IiwiU3ltYm9sIiwiaXRlcmF0b3IiLCJfYXJyIiwiX24iLCJfZCIsIl9lIiwidW5kZWZpbmVkIiwiX3MiLCJfaSIsIm5leHQiLCJkb25lIiwicHVzaCIsImVyciIsIm8iLCJtaW5MZW4iLCJuIiwidG9TdHJpbmciLCJzbGljZSIsImNvbnN0cnVjdG9yIiwibmFtZSIsImZyb20iLCJ0ZXN0IiwiVHlwZUVycm9yIiwiX3RhZ2dlZFRlbXBsYXRlTGl0ZXJhbCIsInN0cmluZ3MiLCJyYXciLCJmcmVlemUiLCJkZWZpbmVQcm9wZXJ0aWVzIiwibGluayIsInJlY29ubmVjdCIsInBsYXlncm91bmQiLCJjbGllbnQiLCJBcG9sbG9DbGllbnQiLCJjYWNoZSIsIkluTWVtb3J5Q2FjaGUiLCJHRVRfTUVTU0FHRVMiLCJncWwiLCJQT1NUX01FU1NBR0UiLCJNZXNzYWdlcyIsInVzZXIiLCJkYXRhIiwidXNlU3Vic2NyaXB0aW9uIiwibWVzc2FnZXMiLCJtYXAiLCJpZCIsIm1lc3NhZ2VVc2VyIiwiY29udGVudCIsInN0eWxlIiwiZGlzcGxheSIsImp1c3RpZnlDb250ZW50IiwicGFkZGluZ0JvdHRvbSIsImhlaWdodCIsIndpZHRoIiwibWFyZ2luUmlnaHQiLCJib3JkZXIiLCJib3JkZXJSYWRpdXMiLCJ0ZXh0QWxpZ24iLCJmb250U2l6ZSIsInBhZGRpbmdUb3AiLCJ0b1VwcGVyQ2FzZSIsImJhY2tncm91bmQiLCJjb2xvciIsInBhZGRpbmciLCJtYXhXaWR0aCIsIkNoYXQiLCJ1c2VTdGF0ZSIsInN0YXRlIiwic2V0U3RhdGUiLCJ1c2VNdXRhdGlvbiIsInBvc3RNZXNzYWdlIiwib25TZW5kIiwidmFyaWFibGVzIiwiQ29udGFpbmVyIiwiZGF0YS10ZXN0aWQiLCJSb3ciLCJDb2wiLCJ4cyIsIkZvcm1JbnB1dCIsImxhYmVsIiwib25DaGFuZ2UiLCJlIiwidGFyZ2V0Iiwib25LZXlVcCIsImtleUNvZGUiLCJCdXR0b24iLCJvbkNsaWNrIiwiQXBvbGxvUHJvdmlkZXIiXSwibWFwcGluZ3MiOiI4SkFHSUEsRUFBaUIsU0FBVUMsR0FFM0IsU0FBU0QsRUFBY0UsR0FDbkIsSUFBSUMsRUFBUUYsRUFBT0csS0FBS0MsT0FBU0EsS0FPakMsT0FOSUgsYUFBMEIsRUFBQUksbUJBQzFCSCxFQUFNSSxtQkFBcUJMLEVBRzNCQyxFQUFNSSxtQkFBcUIsSUFBSSxFQUFBRCxtQkFBbUJKLEVBQWVNLElBQUtOLEVBQWVPLFFBQVNQLEVBQWVRLGVBRTFHUCxFQUtYLE9BZEEsUUFBVUgsRUFBZUMsR0FXekJELEVBQWNXLFVBQVVDLFFBQVUsU0FBVUMsR0FDeEMsT0FBT1IsS0FBS0UsbUJBQW1CSyxRQUFRQyxJQUVwQ2IsRUFmUyxDLFFBZ0JsQixJLDRCQ25CYSxTQUFTYyxFQUFnQkMsRUFBS0MsRUFBS0MsR0FZaEQsT0FYSUQsS0FBT0QsRUFDVEcsT0FBT0MsZUFBZUosRUFBS0MsRUFBSyxDQUM5QkMsTUFBT0EsRUFDUEcsWUFBWSxFQUNaQyxjQUFjLEVBQ2RDLFVBQVUsSUFHWlAsRUFBSUMsR0FBT0MsRUFHTkYsRSw4Q0NaTSxTQUFTUSxFQUFrQkMsRUFBS0MsSUFDbEMsTUFBUEEsR0FBZUEsRUFBTUQsRUFBSUUsVUFBUUQsRUFBTUQsRUFBSUUsUUFFL0MsSUFBSyxJQUFJQyxFQUFJ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InRzbGliXCI7XG5pbXBvcnQgeyBTdWJzY3JpcHRpb25DbGllbnQgfSBmcm9tICdzdWJzY3JpcHRpb25zLXRyYW5zcG9ydC13cyc7XG5pbXBvcnQgeyBBcG9sbG9MaW5rIH0gZnJvbSBcIi4uL2NvcmUvaW5kZXguanNcIjtcbnZhciBXZWJTb2NrZXRMaW5rID0gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoV2ViU29ja2V0TGluaywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBXZWJTb2NrZXRMaW5rKHBhcmFtc09yQ2xpZW50KSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMpIHx8IHRoaXM7XG4gICAgICAgIGlmIChwYXJhbXNPckNsaWVudCBpbnN0YW5jZW9mIFN1YnNjcmlwdGlvbkNsaWVudCkge1xuICAgICAgICAgICAgX3RoaXMuc3Vic2NyaXB0aW9uQ2xpZW50ID0gcGFyYW1zT3JDbGllbnQ7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBfdGhpcy5zdWJzY3JpcHRpb25DbGllbnQgPSBuZXcgU3Vic2NyaXB0aW9uQ2xpZW50KHBhcmFtc09yQ2xpZW50LnVyaSwgcGFyYW1zT3JDbGllbnQub3B0aW9ucywgcGFyYW1zT3JDbGllbnQud2ViU29ja2V0SW1wbCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBXZWJTb2NrZXRMaW5rLnByb3RvdHlwZS5yZXF1ZXN0ID0gZnVuY3Rpb24gKG9wZXJhdGlvbikge1xuICAgICAgICByZXR1cm4gdGhpcy5zdWJzY3JpcHRpb25DbGllbnQucmVxdWVzdChvcGVyYXRpb24pO1xuICAgIH07XG4gICAgcmV0dXJuIFdlYlNvY2tldExpbms7XG59KEFwb2xsb0xpbmspKTtcbmV4cG9ydCB7IFdlYlNvY2tldExpbmsgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmpzLm1hcCIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHtcbiAgaWYgKGtleSBpbiBvYmopIHtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHtcbiAgICAgIHZhbHVlOiB2YWx1ZSxcbiAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICB3cml0YWJsZTogdHJ1ZVxuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIG9ialtrZXldID0gdmFsdWU7XG4gIH1cblxuICByZXR1cm4gb2JqO1xufSIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIF9hcnJheUxpa2VUb0FycmF5KGFyciwgbGVuKSB7XG4gIGlmIChsZW4gPT0gbnVsbCB8fCBsZW4gPiBhcnIubGVuZ3RoKSBsZW4gPSBhcnIubGVuZ3RoO1xuXG4gIGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGxlbik7IGkgPCBsZW47IGkrKykge1xuICAgIGFycjJbaV0gPSBhcnJbaV07XG4gIH1cblxuICByZXR1cm4gYXJyMjtcbn0iLCJpbXBvcnQgYXJyYXlXaXRoSG9sZXMgZnJvbSBcIi4vYXJyYXlXaXRoSG9sZXMuanNcIjtcbmltcG9ydCBpdGVyYWJsZVRvQXJyYXlMaW1pdCBmcm9tIFwiLi9pdGVyYWJsZVRvQXJyYXlMaW1pdC5qc1wiO1xuaW1wb3J0IHVuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5IGZyb20gXCIuL3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5LmpzXCI7XG5pbXBvcnQgbm9uSXRlcmFibGVSZXN0IGZyb20gXCIuL25vbkl0ZXJhYmxlUmVzdC5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gX3NsaWNlZFRvQXJyYXkoYXJyLCBpKSB7XG4gIHJldHVybiBhcnJheVdpdGhIb2xlcyhhcnIpIHx8IGl0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkgfHwgdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkoYXJyLCBpKSB8fCBub25JdGVyYWJsZVJlc3QoKTtcbn0iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBfYXJyYXlXaXRoSG9sZXMoYXJyKSB7XG4gIGlmIChBcnJheS5pc0FycmF5KGFycikpIHJldHVybiBhcnI7XG59IiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gX2l0ZXJhYmxlVG9BcnJheUxpbWl0KGFyciwgaSkge1xuICBpZiAodHlwZW9mIFN5bWJvbCA9PT0gXCJ1bmRlZmluZWRcIiB8fCAhKFN5bWJvbC5pdGVyYXRvciBpbiBPYmplY3QoYXJyKSkpIHJldHVybjtcbiAgdmFyIF9hcnIgPSBbXTtcbiAgdmFyIF9uID0gdHJ1ZTtcbiAgdmFyIF9kID0gZmFsc2U7XG4gIHZhciBfZSA9IHVuZGVmaW5lZDtcblxuICB0cnkge1xuICAgIGZvciAodmFyIF9pID0gYXJyW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3M7ICEoX24gPSAoX3MgPSBfaS5uZXh0KCkpLmRvbmUpOyBfbiA9IHRydWUpIHtcbiAgICAgIF9hcnIucHVzaChfcy52YWx1ZSk7XG5cbiAgICAgIGlmIChpICYmIF9hcnIubGVuZ3RoID09PSBpKSBicmVhaztcbiAgICB9XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIF9kID0gdHJ1ZTtcbiAgICBfZSA9IGVycjtcbiAgfSBmaW5hbGx5IHtcbiAgICB0cnkge1xuICAgICAgaWYgKCFfbiAmJiBfaVtcInJldHVyblwiXSAhPSBudWxsKSBfaVtcInJldHVyblwiXSgpO1xuICAgIH0gZmluYWxseSB7XG4gICAgICBpZiAoX2QpIHRocm93IF9lO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBfYXJyO1xufSIsImltcG9ydCBhcnJheUxpa2VUb0FycmF5IGZyb20gXCIuL2FycmF5TGlrZVRvQXJyYXkuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShvLCBtaW5MZW4pIHtcbiAgaWYgKCFvKSByZXR1cm47XG4gIGlmICh0eXBlb2YgbyA9PT0gXCJzdHJpbmdcIikgcmV0dXJuIGFycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTtcbiAgdmFyIG4gPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobykuc2xpY2UoOCwgLTEpO1xuICBpZiAobiA9PT0gXCJPYmplY3RcIiAmJiBvLmNvbnN0cnVjdG9yKSBuID0gby5jb25zdHJ1Y3Rvci5uYW1lO1xuICBpZiAobiA9PT0gXCJNYXBcIiB8fCBuID09PSBcIlNldFwiKSByZXR1cm4gQXJyYXkuZnJvbShvKTtcbiAgaWYgKG4gPT09IFwiQXJndW1lbnRzXCIgfHwgL14oPzpVaXxJKW50KD86OHwxNnwzMikoPzpDbGFtcGVkKT9BcnJheSQvLnRlc3QobikpIHJldHVybiBhcnJheUxpa2VUb0FycmF5KG8sIG1pbkxlbik7XG59IiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gX25vbkl0ZXJhYmxlUmVzdCgpIHtcbiAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkludmFsaWQgYXR0ZW1wdCB0byBkZXN0cnVjdHVyZSBub24taXRlcmFibGUgaW5zdGFuY2UuXFxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLlwiKTtcbn0iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBfdGFnZ2VkVGVtcGxhdGVMaXRlcmFsKHN0cmluZ3MsIHJhdykge1xuICBpZiAoIXJhdykge1xuICAgIHJhdyA9IHN0cmluZ3Muc2xpY2UoMCk7XG4gIH1cblxuICByZXR1cm4gT2JqZWN0LmZyZWV6ZShPYmplY3QuZGVmaW5lUHJvcGVydGllcyhzdHJpbmdzLCB7XG4gICAgcmF3OiB7XG4gICAgICB2YWx1ZTogT2JqZWN0LmZyZWV6ZShyYXcpXG4gICAgfVxuICB9KSk7XG59IiwiaW1wb3J0IFJlYWN0LCB7IHVzZVN0YXRlIH0gZnJvbSBcInJlYWN0XCI7XG5pbXBvcnQge1xuICBBcG9sbG9DbGllbnQsXG4gIEluTWVtb3J5Q2FjaGUsXG4gIEFwb2xsb1Byb3ZpZGVyLFxuICB1c2VTdWJzY3JpcHRpb24sXG4gIHVzZU11dGF0aW9uLFxuICBncWwsXG59IGZyb20gXCJAYXBvbGxvL2NsaWVudFwiO1xuaW1wb3J0IHsgV2ViU29ja2V0TGluayB9IGZyb20gXCJAYXBvbGxvL2NsaWVudC9saW5rL3dzXCI7XG5pbXBvcnQgeyBDb250YWluZXIsIFJvdywgQ29sLCBGb3JtSW5wdXQsIEJ1dHRvbiB9IGZyb20gXCJzaGFyZHMtcmVhY3RcIjtcblxuLy8gVG8gdXNlIEdyYXBoUUwgU3Vic2NyaXB0aW9ucyB3aXRoIEFwb2xsbyBDbGllbnQsIGNyZWF0ZSB0aGlzIG5ldyBXZWJTb2NrZXRMaW5rXG5jb25zdCBsaW5rID0gbmV3IFdlYlNvY2tldExpbmsoe1xuICB1cmk6IFwid3M6Ly9sb2NhbGhvc3Q6NDAwMC9cIixcbiAgb3B0aW9uczoge1xuICAgIHJlY29ubmVjdDogdHJ1ZSxcbiAgICBwbGF5Z3JvdW5kOiBcIi9wbGF5Z3JvdW5kXCIsXG4gIH0sXG59KTtcblxuY29uc3QgY2xpZW50ID0gbmV3IEFwb2xsb0NsaWVudCh7XG4gIC8vIFN1cHBseSBuZXcgV2ViU29ja2V0TGluayBoZXJlXG4gIGxpbmssXG4gIHVyaTogXCIvZ3JhcGhxbFwiLFxuICBjYWNoZTogbmV3IEluTWVtb3J5Q2FjaGUoKSxcbn0pO1xuXG5jb25zdCBHRVRfTUVTU0FHRVMgPSBncWxgXG4gIHN1YnNjcmlwdGlvbiBnZXRNZXNzYWdlcyB7XG4gICAgbWVzc2FnZXMge1xuICAgICAgaWRcbiAgICAgIGNvbnRlbnRcbiAgICAgIHVzZXJcbiAgICB9XG4gIH1cbmA7XG5cbmNvbnN0IFBPU1RfTUVTU0FHRSA9IGdxbGBcbiAgbXV0YXRpb24gcG9zdE1lc3NhZ2UoJHVzZXI6IFN0cmluZyEsICRjb250ZW50OiBTdHJpbmchKSB7XG4gICAgcG9zdE1lc3NhZ2UodXNlcjogJHVzZXIsIGNvbnRlbnQ6ICRjb250ZW50KVxuICB9XG5gO1xuXG5jb25zdCBNZXNzYWdlcyA9ICh7IHVzZXIgfSkgPT4ge1xuICBjb25zdCB7IGRhdGEgfSA9IHVzZVN1YnNjcmlwdGlvbihHRVRfTUVTU0FHRVMpO1xuICBpZiAoIWRhdGEpIHtcbiAgICByZXR1cm4gPGRpdj5Ob3RoaW5nPC9kaXY+O1xuICB9XG5cbiAgcmV0dXJuIChcbiAgICA8PlxuICAgICAge2RhdGEubWVzc2FnZXMubWFwKCh7IGlkLCB1c2VyOiBtZXNzYWdlVXNlciwgY29udGVudCB9KSA9PiAoXG4gICAgICAgIDxkaXZcbiAgICAgICAgICBzdHlsZT17e1xuICAgICAgICAgICAgZGlzcGxheTogXCJmbGV4XCIsXG4gICAgICAgICAgICBqdXN0aWZ5Q29udGVudDogdXNlciA9PT0gbWVzc2FnZVVzZXIgPyBcImZsZXgtZW5kXCIgOiBcImZsZXgtc3RhcnRcIixcbiAgICAgICAgICAgIHBhZGRpbmdCb3R0b206IFwiMWVtXCIsXG4gICAgICAgICAgfX1cbiAgICAgICAgPlxuICAgICAgICAgIHt1c2VyICE9PSBtZXNzYWdlVXNlciAmJiAoXG4gICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgICAgaGVpZ2h0OiA1MCxcbiAgICAgICAgICAgICAgICB3aWR0aDogNTAsXG4gICAgICAgICAgICAgICAgbWFyZ2luUmlnaHQ6IFwiMC41ZW1cIixcbiAgICAgICAgICAgICAgICBib3JkZXI6IFwiMnB4IHNvbGlkICNlNWU2ZWFcIixcbiAgICAgICAgICAgICAgICBib3JkZXJSYWRpdXM6IDI1LFxuICAgICAgICAgICAgICAgIHRleHRBbGlnbjogXCJjZW50ZXJcIixcbiAgICAgICAgICAgICAgICBmb250U2l6ZTogXCIxOHB0XCIsXG4gICAgICAgICAgICAgICAgcGFkZGluZ1RvcDogNSxcbiAgICAgICAgICAgICAgfX1cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAge21lc3NhZ2VVc2VyLnNsaWNlKDAsIDIpLnRvVXBwZXJDYXNlKCl9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICApfVxuICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgIHN0eWxlPXt7XG4gICAgICAgICAgICAgIGJhY2tncm91bmQ6IHVzZXIgPT09IG1lc3NhZ2VVc2VyID8gXCIjNThiZjU2XCIgOiBcIiNlNWU2ZWFcIixcbiAgICAgICAgICAgICAgY29sb3I6IHVzZXIgPT09IG1lc3NhZ2VVc2VyID8gXCJ3aGl0ZVwiIDogXCJibGFja1wiLFxuICAgICAgICAgICAgICBwYWRkaW5nOiBcIjFlbVwiLFxuICAgICAgICAgICAgICBib3JkZXJSYWRpdXM6IFwiMWVtXCIsXG4gICAgICAgICAgICAgIG1heFdpZHRoOiBcIjYwJVwiLFxuICAgICAgICAgICAgfX1cbiAgICAgICAgICA+XG4gICAgICAgICAgICB7Y29udGVudH1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICApKX1cbiAgICA8Lz5cbiAgKTtcbn07XG5cbmNvbnN0IENoYXQgPSAoKSA9PiB7XG4gIGNvbnN0IFtzdGF0ZSwgc2V0U3RhdGVdID0gdXNlU3RhdGUoe1xuICAgIHVzZXI6IFwiSmFja1wiLFxuICAgIGNvbnRlbnQ6IFwiXCIsXG4gIH0pO1xuICBjb25zdCBbcG9zdE1lc3NhZ2VdID0gdXNlTXV0YXRpb24oUE9TVF9NRVNTQUdFKTtcblxuICBjb25zdCBvblNlbmQgPSAoKSA9PiB7XG4gICAgaWYgKHN0YXRlLmNvbnRlbnQubGVuZ3RoID4gMCkge1xuICAgICAgcG9zdE1lc3NhZ2Uoe1xuICAgICAgICB2YXJpYWJsZXM6IHN0YXRlLFxuICAgICAgfSk7XG4gICAgfVxuICAgIHNldFN0YXRlKHtcbiAgICAgIC4uLnN0YXRlLFxuICAgICAgY29udGVudDogXCJcIixcbiAgICB9KTtcbiAgfTtcblxuICByZXR1cm4gKFxuICAgIDxDb250YWluZXIgZGF0YS10ZXN0aWQ9XCJjaGF0LWFwcFwiPlxuICAgICAgPE1lc3NhZ2VzIHVzZXI9e3N0YXRlLnVzZXJ9IC8+XG4gICAgICA8Um93PlxuICAgICAgICA8Q29sIHhzPXsyfSBzdHlsZT17eyBwYWRkaW5nOiAwIH19PlxuICAgICAgICAgIDxGb3JtSW5wdXRcbiAgICAgICAgICAgIGxhYmVsPVwiVXNlclwiXG4gICAgICAgICAgICB2YWx1ZT17c3RhdGUudXNlcn1cbiAgICAgICAgICAgIG9uQ2hhbmdlPXsoZSkgPT4gc2V0U3RhdGUoeyAuLi5zdGF0ZSwgdXNlcjogZS50YXJnZXQudmFsdWUgfSl9XG4gICAgICAgICAgLz5cbiAgICAgICAgPC9Db2w+XG4gICAgICAgIDxDb2wgeHM9ezh9PlxuICAgICAgICAgIDxGb3JtSW5wdXRcbiAgICAgICAgICAgIGRhdGEtdGVzdGlkPVwibWVzc2FnZS1pbnB1dFwiXG4gICAgICAgICAgICBsYWJlbD1cIlVzZXJcIlxuICAgICAgICAgICAgdmFsdWU9e3N0YXRlLmNvbnRlbnR9XG4gICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IHNldFN0YXRlKHsgLi4uc3RhdGUsIGNvbnRlbnQ6IGUudGFyZ2V0LnZhbHVlIH0pfVxuICAgICAgICAgICAgb25LZXlVcD17KGUpID0+IHtcbiAgICAgICAgICAgICAgaWYgKGUua2V5Q29kZSA9PT0gMTMpIHtcbiAgICAgICAgICAgICAgICBvblNlbmQoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfX1cbiAgICAgICAgICAvPlxuICAgICAgICA8L0NvbD5cbiAgICAgICAgPENvbCB4cz17Mn0gc3R5bGU9e3sgcGFkZGluZzogMCB9fT5cbiAgICAgICAgICA8QnV0dG9uIG9uQ2xpY2s9eygpID0+IG9uU2VuZCgpfT5TZW5kPC9CdXR0b24+XG4gICAgICAgIDwvQ29sPlxuICAgICAgPC9Sb3c+XG4gICAgPC9Db250YWluZXI+XG4gICk7XG59O1xuXG5leHBvcnQgZGVmYXVsdCAoKSA9PiAoXG4gIDxBcG9sbG9Qcm92aWRlciBjbGllbnQ9e2NsaWVudH0+XG4gICAgPENoYXQgLz5cbiAgPC9BcG9sbG9Qcm92aWRlcj5cbik7XG4iXSwic291cmNlUm9vdCI6IiJ9